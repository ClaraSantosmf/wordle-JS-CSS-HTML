// Palavra do dia está fixa, deve ser trocado pela API. Vamos trabalhar ela em uppercase https://rapidapi.com/sheharyar566/api/random-words5/?utm_source=ANIA-KUBOW&utm_medium=DevRel&utm_campaign=DevRel

let wordList = ["SAGAZ", "AMORA", "PINTO","AMAGO","NEGRO","EXITO","MEXER","TERMO","NOBRE","SENSO","ARDER","BOLHA","ROLHA","CIIRCO","FALIR","PEDIR","AFETO","PLENA","ETICA","MUTUA","TENUE","SUTIL","VIGOR","AQUEM","FAZER","POREM","AUDAZ","ASSIM","SANAR","SEÇAO","INATO","CERNE","FOSSE","IDEIA","PODER","MORAL","DESDE","TORPE","MUITO","JUSTO","HONRA","FUTIL","SOBRE","ANEXO","QUIÇA","RAZAO","ETNIA","ICONE","SONHO","TANGE","EGIDE","LAPSO","AMIGO","MUTUO","EXPOR","HAVER","HABIL","TEMPO","SEARA","DENGO","ENTAO","PESAR","AVIDO","POSSE","GENRO","BOÇAL","COSER","ARDIL","CAUSA","CORJA","DIZER","PARIA","PROLE","DETEM","TENAZ","DEVER","GRAÇA","SABER","OBICE","CRIVO","DIGNO","APICE","ANIMO","ANSIA","CEDER","BRADO","COMUM","SENDO","TEMOR","GLEBA","CULTO","ASSAZ","ATROZ","MUNDO","PAUTA","CENSO","FUGAZ","AINDA","COZER","VALHA","DENSO","NENEM","VICIO","ESTAR","FORTE","VULGO","REVES","PUDOR","REGRA","DOGMA","LOUCO","CRIAR","BANAL","ROUND","IMPOR","SAUDE","JEITO","ATRAS","ORDEM","TENRO","PIFIO","DESSE","APRAZ","PEDIR","MERCE","REAÇA","CLAVA","USURA","PROSA","FELIZ","JUIZO","SERVO","VIRIL","SABIO","COISA","MANSO","ONTEM","PRESA","FALAR","CUNHO","FORMA","DEVIR","MESMO","MEIGA","AFAGO","FLUIR","EBRIO","PLATO","VENDO","LIMBO","SERIO","GUISA","MAGOA","POSSO","VISAR","HEROI","TEMER","ACASO","PLENO","PUDER","VALOR","CISMA","BRUMA","LUGAR","IMPIO","EXODO","AFINS","OBVIO","CERTO","GERAR","OBTER","CRISE","MATIZ","PRAXE","SENIL","HAVIA","TODOS","VENIA","FLUXO","ENFIM","ABRIR","TEDIO","RITMO","ALIBI","FALSO","UNIAO","TOMAR","GARBO","VISAO","PARVO","FACIL","VALIA","RETER","PULHA","VITAL","FAVOR","BRAVO","GRATO","PRUMO","VIVAZ","LEGAL","PARCO","GENIO","LAICO","BURRO","OLHAR","POSSA","LEVAR","AMENO","RELES","TECER","CASTA","OBITO","PRIME","SELAR","MORTE","RANÇO","ANELO","FATOR","NOÇAO","SABIA","ROGAR","NOITE","FAÇAM","CITAR","FARSA","CABAL","ACHAR","FALTA","ADIAR","NICHO","COESO","EPICO","CISAO","OUVIR","FARDO","BREGA","VIVER","ATIVO","FORÇA","SINTO","GENTE","EXATO","IMUNE","PASSO","SONSO","AMPLO","DUBIO","LINDA","TENDO","CESTA","UNICO","SULCO","LAVRA","LEIGO","SESTA","CALMA","REVEL","DETER","LABOR","VEMOS","REVER","GESTO","HUMOR","ARDUO","ATUAR","POBRE","FEIXE","CIUME","CARMA","AJUDA","TENDE","OUTRO","OTICA","IGUAL","VELHO","PONTO","CLARO","TOADA","HIATO","IDEAL","SONSA","DEBIL","VACUO","TERNO","AMBOS","REMIR","FUSAO","PROBO","SENAO","FONTE","MARCO","JOVEM","LEITO","ADVEM","CAPAZ","INATA","TERRA","DOIDO","HORDA","XEQUE","RELVA","TENRA","FICAR","ALGUM","VELAR","CAÇAR","SERIE","FARAO","LIDER","APOIO","COÇAR","VAZIO","ANUIR","TANTO","VIMOS","RIGOR","VERSO","ENTRE","DORSO","BOTAR","FRASE","POUCO","SIGNO","SENTE","MASSA","COESA","CRUEL","RAIVA","MOÇAO","PRECE","AMBAS","VIRUS","FEITO","FAUNA","MORAR","PESTE","MINHA","PAPEL","CASTO","COVIL","CREDO","PRESO","TORÇO","CICLO","IMPAR","FAINA","LAZER","FUROR","BRISA","DOCIL","FLORA","CHATA","MAIOR","VETOR","TRAMA","ARIDO","BLASE","HOUVE","PEGAR","NOSSA","ACESO","BEATA","ADEUS","BANZO","MANHA","SETOR","VULTO","LIAME","BREVE","SENDA","SEITA","VASTO","SALVO","ARDOR","LIVRO","PEIXE","MORRO","VISSE","CHUVA","PECHA","SORTE","ATOMO","COMER","ANTRO","PRADO","REGER","PLANO","SAIBA","OCASO","SEGUE","REZAR","AVARO","CARRO","PAJEM","NUNCA","ALIAS","SAIDA","OTIMO","AUREO","JUNTO","MUDAR","ANCIA","ACIMA","CHULO","SERAO","OPÇAO","FITAR","PARAR","JAZIA","FRUIR","TRETA","FUGIR","NAÇAO","ANDAR","GRUPO","BANDO","PRAZO","LEITE","GERIR","LENDA","MOTIM","NORMA","TOSCO","ALUDE","RAPAZ","BRAVA","PARTE","EPOCA","CAMPO","SINHA","TENSO","EXAME","IDOLO","AVIAO","ARCAR","PSICO","TIRAR","REINO","MALTA","VENAL","AGORA","VILAO","PRAGA","SOLDO","PRAIA","QUOTA","RISCO","AONDE","INDIO","CORPO","ANTES","LOGRO","SUMIR","PRETO","VIRAO","TRAGA","VORAZ","FIXAR","POMPA","CHEIO","QUASE","TEXTO","EXIJO","FILHO","CERTA","TURBA","COPIA","NODOA","OASIS","APEGO","PROVA","ALADO","SOLTO","CAIXA","TURVA","ACESA","ESTAO","MESSE","CONTA","GRAVE","LIGAR","ATRIO","VERBO","NIVEL","DOIDO","VERVE","PARVA","APELO","TOCAR","AUREA","LINDO","TRUPE","PARDO","FESTA","LIVRE","FENDA","FRACO","DESSA","SABIA","OPACO","AFORA","ALÇAR","OXALA","VIRIA","NAVIO","PARCA","JIRAU","RETEM","FICHA","ASTRO","MANHA","FATOS","FAIXA","ETICO","ELITE","LIDAR","MENTE","FATAL","GLOSA","SUPRA","TINHA","AUTOR","FIRME","MAGIA","GRATA","VERBA","CIOSO","BATER","RESES","PIQUE","CALDA","COUSA","JUNCO","SALVE","DEIXA","PRIVE","IRMAO","PAGAO","DOUTO","MACIO","ATUAL","MOLHO","ABRIU","POSTO","LIGHT","SUPOR","TORSO","SEXTA","VEZES","TURVO","SARÇA","LONGE","ASILO","EXTRA","IGNEO","JUDEU","CURSO","ORFAO","CABER","DROPS","LOCUS","PORTA","OSSOS","LATIR","GALHO","CANOA","LAGOA","ARARA","CINCO","BESTA","CINZA","LILAS","CRASE","TOUCA","BOTAO","ROUCA","RADIO","DESTA","RUINA","CORSA","PALIO","PALHA","VIDEO","ZELAR","COMBO","VOSSO","NOSSO","VINHA","CULPA","BIOMA","MENOS","ERETO","FINDA","PAIRA","BONUS","AGUDO","FEUDO","FACTO","ADVIR","URGIA","CUTIS","TRAÇO","MEIGO","SURJA","TETRA","SITIO","SUPER","JULIA","FACHO","SUAVE","AUTOS","AMENA","RUMOR","TENTO","PILAR","TURMA","COCHO","CLEAN","MUSEU","CHAMA","AÇOES","LOUÇA","LASSO","GERAL","MOSTO","LAPIS","LOCAL","HOBBY","ACOLA","OPTAR","PODIO","BOATO","MEDIR","RUBRO","PACTO","CRIME","REFEM","FOLGA","BRABO","PENTA","PAREO","LETAL","PONHA","DRAMA","POEMA","ALUNO","MESMA","MOVEL","CACHO","FEROZ","VIGIA","AROMA","METIE","HOSTE","CHATO","AVIDA","COVER","GOLPE","VETAR","PASMO","MONTE","RIVAL","TESTE","FAZIA","PIADA","FINJO","CORAL","ECOAR","AXILA","FORUM","LIMAO","DAQUI","FOREM","RISTE","VERDE","POETA","CARTA","MONGE","MIOLO","TENTE","PLEBE","CLIMA","ARTUR","PASSA","LESSE","SUCIA","CETRO","EBANO","TACHA","ESCOL","ATEIA","CALMO","BRIGA","FALHA","VENHA","ROUPA","MACRO","BUSCA","CONTO","SARAU","IDOSO","PLUMO","CARGO","VIRAM","AVISO","TRIBO","PLAGA","PERCO","FRUTO","TARDE","LEGUA","ATIMO","FARTA","CHEFE","BERRO","VENTO","GRAMA","VIRAR","CIVIL","CATRE","ARADO","CORSO","SURTO","SEIXO","ORNAR","SALDO","ASSAR","TRAJE","UNICA","BRUTA","PEDRA","MANGA","BEIJO","NUVEM","AMIGA","FOSSO","RECEM","TROCA","MANGA","DESTE","CASAR","GIRIA","UTEIS","TRATO","MAGNA","PORTE","VEDAR","SOSIA","DEPOR","ARFAR","DERAM","CANSO","TIVER","ITENS","AMADO","TUTOR","AMBAR","SILVO","IRADO","GROTA","BAZAR","CIFRA","VAZAO","GABAR","RENDA","PINHO","PERTO","BRUTO","RURAL","JEJUM","LAUDO","PASMA","MIDIA","PAVOR","REGIO","INTER","FEITA","TCHAU","SEGAR","NESSE","FOSSA","ORGAO","MINAR","ODIAR","TROCO","VAGAR","VADIO","MOLDE","CLERO","POMAR","SOTAO","LESTO","STAND","AVIAR","AMADA","NEGAR","MAMAE","CENHO","CANTO","ROCHA","LESAO","CINTO","LARGO","PAIOL","VISTO","BOLSA","HORTO","CLOSE","PROTO","RUIDO","ILESO","MORFO","DENSA","XUCRO","PUGNA","INVES","MARCA","JOGAR","PODAR","VISTA","URDIR","CHULA","UFANO","PENSO","VASTA","MOCHO","FROTA","CIVEL","CHEIA","BULIR","UMIDO","PICHE","UBERE","LINHA","ESGAR","PEITA","RESTO","APEAR","TENHA","SANTO","MISTO","FUNDO","AGAPE","VOLTA","MANTO","CERCA","NARCO","LOGOS","NESSA","NATAL","MONTA","VELHA","DEMAO","SIMIO","JAZER","FAZES","FINDO","BARAO","CAMPA","FERPA","VERAO","PREGO","CHAGA","ARDIS","POLIS","MOVER","ALBUM","LETRA","COSMO","ETAPA","BALAO","TROPA","CALVO","LINDO","POSTE","PINGO","POLIR","RETRO","NESTA","SEIVA","BANTO","MATAR","FOLIA","COROA","VENHO","TRAGO","ALAMO","TROCO","PUNHA","CEITA","AUDIO","FINAL","SABOR","BARRO","REDOR","LOURO","RENTE","CALMA","SIGLA","SALVA","BOLSO","FIRMA","ARROZ","QUEDA","FAROL","TORNA","COEVO","FOLHA","ENJOO","LUTAR","SOLTA","LOUSA","TUMBA","MIOPE","MIMAR","BURRA","BAIXA","NESTE","SALMO","FUGIU","OUSAR","TODAS","VELOZ","CORAR","ZUMBI","NACAR","CALOR","LONGO","RELER","FORRO","VASCO","OBTEM","JUSTA","VAZIA","FATUO","PENCA","QUERO","ILHAS","CACTO","CALVO","GUETO","BEDEL","FELIZ","VARIO","FARTO","CHAVE","LIMAO","MEIAO","LOGIA","MANIA","LUCRO","QUITE","REPOR","SUGAR","SEXTO","PUIDO","CUSTO","SUBIR","STAFF","ULTRA","URGIR","PASSE","SADIO","REFIL","VIGER","VALER","VERSA","HIFEN","LENTO","LOUCA","USUAL","CARDO","REDEA","NARIZ","SOCIO","CORTE","MOURO","AEREO","CEIFA","MODAL","FERIR","GARRA","VOILÀ","ANZOL","ABADE","NESGA","PLUMA","SOFIA","OUTRA","PATIO","DADOS","GRIFE","LABIL","DIABO","RAIAR","PAVIO","SABIA","TRAIR","SKATE","PAGAR","ROUBO","PAZES","DIQUE","XAMPU","TACHO","PODRE","DISSO","SURRA","TIBIO","FILME","ABONO","CAIBO","CISCO","FAREI","DOBRO","JEOVA","DOMAR","DIGNA", "COUVE", "QUAIS","POSTA", "REGIA", "NOTAR", "BRUXA", "BARRA","REGEM","VOLTO", "TOQUE","BURIL", 'APOIS', 'AVEXE','AVIAR','BANHA','MUIDO','BABAO','BESTA','BOIAR','BULIR','CARAI','CABRA','ACUNHA','BRIBA','FROXO','FILAR','GIBAO','GRAXA','MUIER','MANGA','MASSA','MIGUE','PENSE','RELAR','TORAR','VIADO','ZOADA','MACHO','OPAIO','MERMO','ZOADA','VALHA','PRONTO']


const palavrasPossiveis ={
'01':['APOIS', 'Pronto'],
'02':['AVEXE','Se apresse'],
'03':['MUIDO', 'Confusão!'], 
'04':['AVIAR', 'Apesar'],
'05':['BANHA', 'Tomar banho'],
'06':['BABAO', 'Puxa-saco'],
'07':['BESTA', 'Desnorteado'],
'08':['BOIAR', 'Perdido'],
'09':['BULIR', 'Mexer'],
'10':['CARAI', 'Xingamento'],
'11':['CABRA', 'Homem'],
'12':['ACUNHA', 'Apresse'],
'13':['BRIBA', 'Inceto'],
'14':['FROXO', 'Pessoa com pouca coragem'],
'15':['FILAR', 'Colar na escola'],
'14':['GIBAO', 'Casaco de couro'],
'16':['GRAXA', 'Molho de carne'],
'17':['MUIER', 'Mulher'],
'18':['MANGA', 'Fruta e xingamento'],
'19':['MASSA', 'Muito bom'],
'20':['MIGUE', 'Disfarçar'],
'21':['PENSE', 'Ironia'],
'22':['RELAR', 'Arranhar'],
'23':['TORAR', 'Forçar, intensidade'],
'24':['VIADO', 'Vocativo de amigo, pessoa animada'],
'25':['PRONTO', 'Feito. Realizado. Combinado'],
'26':['ZOADA', 'Muito RUim'],
'27':['MACHO', 'Homem'],
'28':['OPAIO', 'Olhe para isso'],
'29':['MERMO', 'Mesma coisa, igual'],
'30':['ZOADA', 'Muito barulho'],
'31':['VALHA', 'Deus me livre']}

const diaDeHoje = new Date().getDate()
console.log(diaDeHoje)

const palavraDoDia = Object.values(palavrasPossiveis[diaDeHoje])[0]

const dica = Object.values(palavrasPossiveis[diaDeHoje])[1]

// Linha inicial

let linha = 1

// array que receberá as letras de cada rodada. Esse será reiniciado a cada linha 

let entrada = []

// Função calculaOcorrencia é um reduce que contabiliza quantas vezes uma determinada letra estar presente na palavra do dia em formato de dicionário. Isso ajuda na comparação da entrada com a palavra do dia. 

function calculaOcorrencia(palavraContada){
    return palavraContada.split('').reduce(function(letras, letraNova) {if (Object.keys(letras).includes(letraNova)) letras[letraNova] += 1
        else letras[letraNova] = 1
        return letras 
    }, {})
}
// Palavra transformada pela função

const ocorrenciasPalavraDoDia = calculaOcorrencia(palavraDoDia)


// Função para finalizar o jogo

function venceuJogo(){
    let contador = 0
    startConfetti();
    setInterval(function(){
        if (contador == 5){
            stopConfetti()
        }
        contador++
    }, 1000)
    return
}


function fimDeJogo(){
}

// Função que escuta o teclado e trata os casos com a captura do key do evento

function ouvinteDeTeclas (key) {
    let char = key;
    let alfabeto = [
        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z', 'ENTER', 'BACKSPACE'];

    // ifs que permite apenas inserção de teclas válidas.

    if (!alfabeto.includes(char)) {
        console.log('tecla inválida', char)
        return null;
    }

    if (char == 'ENTER') {
        if (wordList.includes(entrada.join('')))
        {
            if (!validarEntrada()) return; 
            if (linha > 6){
                fimDeJogo()};
             linha += 1
             return;
        } else {
            alert('Essa não é uma expressão nordestina')
        }
    }

    //If localiza o ID o último quadradinho preenchido, coloca um espao vazio com textContent e retira o elemento da lista 

    if (char == 'BACKSPACE'){
        if (entrada.length !=0 ){
            let elId = `l${linha}c${entrada.length}`
            const el = document.getElementById(elId)
            el.textContent = ''
            entrada.pop();
        }
        return;
    }

    //if com limitador de inserção de elementos quando a entrada e exibição de letras acima de 5.  

    if (entrada.length < 5){
        entrada.push(char)  
    }
    if (entrada.length <= 5){
        exibeLetra()  
    }

}

// Função que exibte letra no local correto

function exibeLetra(letra) {
    let elId = `l${linha}c${entrada.length}`
    const el = document.getElementById(elId)
    el.textContent = entrada[entrada.length-1]
}

// Função que captura entrada 

function validarEntrada() {

    // Foi preciso usar o .join porque a entrada já vem como array
    // const ocorrenciaDaEntrada = calculaOcorrencia(entrada.join(''))
    const ocorrenciaDaEntrada = {}

    // Trava para que haja 5 letras
    if (entrada.length != 5){
        alert('Precisamos de uma palavra de 5 letras')
        return false
    }

    // Validador de Palavra certa.

    if (entrada.join('') == palavraDoDia.toUpperCase()){
        for (i = 0; i < 5; i++){
        document.getElementById(`l${linha}c${i+1}`).classList.add("fullcorrect")
        }
        venceuJogo()
        return
    }

    // validador de cores
    // validador de algumas letras fullcorrect

    for (i = 0; i < 5; i ++){ 
        let letra = entrada[i];
        if (letra == palavraDoDia[i]){
            document.getElementById(`l${linha}c${i+1}`).classList.add("fullcorrect")
            ocorrenciaDaEntrada[letra] = (ocorrenciaDaEntrada[letra] || 0) + 1
            continue
            
        }
        // se eu considerar que ocorrencia da letra da entrada for maior que ocorrencia da palavra do dia, afeta e pinta tudo de amarelo. Caso considere o contrário, ele limita os amarelos a partir da quarta linha. pq?

        if (palavraDoDia.includes(letra) && (ocorrenciaDaEntrada[letra] || 0) < ocorrenciasPalavraDoDia[letra]){
            document.getElementById(`l${linha}c${i+1}`).classList.add("correct")
            ocorrenciaDaEntrada[letra] = (ocorrenciaDaEntrada[letra] || 0) + 1
            // ocorrenciaDaEntrada[letra]--
            continue
            
        }  
        document.getElementById(`l${linha}c${i+1}`).classList.add("incorrect")}
    entrada=[]
    return true
}

    document.body.addEventListener('keydown', function(e){return ouvinteDeTeclas(e.key.toUpperCase())})

    const teclas  = document.querySelectorAll('.tecla')

    function tecladoVirtual(event) {
        if(event.target.classList.contains('delete')){
            return ouvinteDeTeclas('BACKSPACE')
        } else {
            return ouvinteDeTeclas(event.target.innerHTML.toUpperCase())
        }
        
    }
   
    document.getElementById("dica").innerText = dica
            
 
// const ocorrencias = Object.assign({}, ocorrenciasPalavraDoDia)
// DESAFIOS
// Locahistorege para saber quantas vezes o cara jogou, se ele jogou.
// share, como compartilhar nas redes sociais? Tudo verdinho quando acabei
// Palavra válida - listar palavras com cinco eltras com uma constante
// navegador sabe que é tres vezes

